{{extend 'layout.html'}}

<div class="row-fluid import">
	<div class="span6">
	    <div class="widget-box">
	        <div class="widget-title">
	            <span class="icon">
	             <i class="icon-align-justify"></i>
	            </span>
	            <h5>Import CORE Impact Exploits File</h5>
	        </div>
	        <div class="widget-content">
	        {{=form}}
	        </div>
	    </div>
	</div>
    <div class="alert alert-info span6">
        <p>CORE Impact uses an internal SQL database so a file must be generated to import the exploits file.</p>

        <p>The following SQL command will do the trick. Save it on your CORE Impact workstation</p>

        <pre>
SET NOCOUNT ON
USE corevuln

SELECT ('CVE-' + CAST(v.vuln_ncve_year as VARCHAR) + '-' + CAST(v.vuln_ncve_number as VARCHAR)) as 'CVE',
QUOTENAME(v.vuln_description as 'Vulnerability Description', '"'), e.expl_id as 'Impact Exploit ID',
e.expl_name as 'Impact Exploit Name', e.expl_date_create as 'Exploit Created'
FROM exploit e INNER JOIN expl_vuln ev
    ON e.expl_id = ev.exvu_expl_id INNER JOIN vulnerability v
    ON ev.exvu_vuln_id = v.vuln_id
ORDER BY v.vuln_ncve_year ASC, v.vuln_ncve_number ASC
        </pre>

        <p>This file is also available at <a href="{{=URL(request.application, 'static/etc/core_impact_exploits.txt')}}">$KVASIR/static/etc/core_impact_exploits.txt</a></p>

        <p>Once loaded on your workstation, run the following command to generate the output file:</p>

        <pre>sqlcmd -S "{hostname}\impact" -i core_impact_exploits.sql -o core_impact_exploits.txt -W -s "," -m1 -h-1</pre>

        <p>Replace "{hostname}" with localhost or your database hostname.</p>
    </div>
</div>

{{include 'loading.html'}}
